# ♻️ AI 기반 생활 폐기물 분류 시스템 (Waste Classification AI System)

## 🌟 1. 프로젝트 개요

| 항목 | 내용 |
| :--- | :--- |
| **프로젝트명** | AI 기반 생활 폐기물 분류 시스템 (Waste Classification AI System) |
| **프로젝트 목표** | 5가지 폐기물 카테고리(캔, 유리, 종이, 플라스틱, 일반쓰레기)를 정확하게 자동 분류하는 AI 모델을 구축하고 웹 서비스에 배포 |
| **개발 동기** | 육안으로 구분하기 어려운 일반쓰레기와 재활용품의 경계를 명확히 구분하여 재활용 효율 증대 |

## 🛠️ 2. 개발 환경 및 도구

| 항목 | 내용 |
| :--- | :--- |
| **언어** | Python 3.x |
| **AI 프레임워크** | PyTorch (TorchVision) |
| **AI 모델** | EfficientNet-B0 (전이 학습) |
| **백엔드 서버** | FastAPI, Uvicorn |
| **데이터셋** | 5-Class Custom Dataset (`can`, `general`, `glass`, `paper`, `plastic`) |
| **GPU 가속** | CUDA |

## ⚙️ 3. 시스템 구조

| 구성 요소 | 역할 |
| :--- | :--- |
| **사용자 이미지 입력** | 웹 인터페이스를 통해 폐기물 이미지 파일을 서버로 업로드 |
| **이미지 전처리** | 입력 이미지를 224x224로 리사이즈 및 정규화 |
| **CNN 분류 모델** | EfficientNet-B0 모델이 이미지 특징을 추출하고 5가지 클래스로 분류 |
| **FastAPI 서버** | 클라이언트 요청 수신, AI 모델 로드 및 추론 실행, JSON 형태로 결과 반환 |
| **웹 UI 출력** | 예측된 클래스 및 신뢰도를 사용자에게 표시 |

## 📈 4. 모델 학습 및 성능

| 항목 | 내용 |
| :--- | :--- |
| **모델 구조** | EfficientNet-B0 (Fully Connected Layer를 5개 클래스로 변경) |
| **입력** | RGB 이미지 (224x224 픽셀) |
| **출력 클래스** | Can, General, Glass, Paper, Plastic (5가지) |
| **손실 함수 / 옵티마이저** | CrossEntropyLoss / Adam (ReduceLROnPlateau 스케줄러 적용) |
| **최고 검증 정확도** | **[trainer.py 로그에 기록된 최종 최고 정확도]%** |
| **평균 추론 시간** | 약 0.2초 ~ 0.5초 (GPU 환경 기준) |

## 🎯 5. 문제점 및 해결 과정

본 프로젝트는 특히 **일반쓰레기(General)와 플라스틱(Plastic)의 오분류** 문제 해결에 집중했습니다.

### 5.1 일반쓰레기 오분류 문제 (데이터 보강)

* **문제:** 초기 모델은 복합 재질이나 오염된 일반쓰레기를 깨끗한 플라스틱으로 오분류하는 경향이 강했습니다.
* **해결:** 오염되거나 재활용이 불가능한 **실제 일반쓰레기 사진 101장**을 확보하여 `dataset/general` 폴더를 보강했습니다.
* **결과:** 재학습을 통해 `general` 클래스의 인식률이 대폭 향상되었습니다.

### 5.2 🔴 개발 중 느낀 가장 어려운 부분: 배경색 의존성 (과적합 해결)

* **문제:** 일반쓰레기 사진을 **흰색 배경**에서 촬영할 경우, 모델이 물체의 특징이 아닌 **'흰색 배경'**을 보고 `plastic`으로 잘못 판단하는 **배경색 과적합(Overfitting)** 문제가 발생했습니다.
* **해결:**
    * `trainer.py`의 이미지 전처리 로직 중 `ColorJitter` 파라미터를 강화했습니다. **밝기(brightness)와 대비(contrast) 값을 0.3으로 높여** 학습 데이터의 조명 및 색상을 무작위로 강하게 변조했습니다.
    * **적용 코드:** `transforms.ColorJitter(brightness=0.3, contrast=0.3, saturation=0.3, hue=0.1)`

### 5.3 서버 실행 환경 오류

* **문제:** `app.py` 실행 시 포트 8000 충돌(`Errno 10048`) 오류가 반복적으로 발생했습니다.
* **해결:** `netstat -ano | findstr :8000` 명령어로 사용 중인 프로세스 ID(PID)를 찾아 `taskkill /pid [PID] /f` 명령어로 강제 종료하여 포트를 확보하고 서버를 안정화했습니다.

### 5.4 개발 중 느낀 점
AI 시스템은 단순히 모델만이 아니라 **학습 데이터의 질적 관리**와 **특정 환경(배경색)**에 모델이 취약해지지 않도록 하는 **데이터 증강 전략**이 핵심임을 깨달았습니다.

## 6. 결과 분석 및 향후 개선 방향

### 6.1 결과 분석
최종 모델은 데이터 보강과 증강 강화를 통해 **[최고 정확도]%**의 검증 정확도를 달성했습니다. 특히, 일반쓰레기 분류 정확도가 획기적으로 개선되어, **흰색 배경에서의 테스트에서도 안정적으로 general 클래스를 예측**하는 것을 확인하였습니다.

### 6.2 향후 개선 방향
* **실시간 카메라 모듈 통합:** 웹캠이나 모바일 카메라를 통한 실시간 분류 기능 추가.
* **추가 클래스 확장:** 의류, 음식물 폐기물 등 분류 카테고리를 확장하여 시스템의 활용 범위 확대.

## 7. 제출 형식

| 항목 | 내용 |
| :--- | :--- |
| **시연 영상** | 웹 서버 접속, 흰색 배경 일반쓰레기 이미지 업로드, 분류 결과(General) 시각화 확인 |
| **부록 캡처** | 서버 실행 성공 화면, 웹 UI 메인 화면, 최종 분류 결과 화면 |

---

## 📎 8. 부록 (최종 동작 화면 캡처)

### 8.1 서버 실행 성공 화면 캡처

FastAPI 서버가 포트 8000번에서 정상적으로 실행된 화면입니다.
*첨부할 이미지: Uvicorn running on http://127.0.0.1:8000 로그가 보이는 터미널 캡처*
\[여기에 서버 실행 성공 캡처 이미지를 삽입하세요]

### 8.2 AI 분류 시스템 웹 UI (메인 화면)

AI 분류 도우미의 메인 화면입니다.
*첨부할 이미지: 프로젝트의 메인 웹 UI 캡처*
\[여기에 메인 UI 캡처 이미지를 삽입하세요]

### 8.3 최종 분류 결과 화면 캡처 (문제 해결 증명)

데이터 보강 및 모델 재학습 후, 가장 문제가 되었던 일반쓰레기(흰색 배경)를 정확하게 분류한 최종 결과입니다.

| 항목 | 내용 |
| :--- | :--- |
| **업로드된 이미지** | 흰색 배경에 놓인 일반쓰레기 (칫솔, 오염된 비닐 등) 사진 |
| **AI 분석 결과** | **일반쓰레기 (General)** |
| **신뢰도** | **[분류 시 나온 실제 신뢰도]%** |
*첨부할 이미지: 일반쓰레기(General)가 높은 신뢰도로 정확하게 분류된 웹 UI 캡처*
\[여기에 최종 분류 결과 캡처 이미지를 삽입하세요]

---
## 9. 참고 문헌
* Tan, M., & Le, Q. V. (2019). EfficientNet: Rethinking Model Scaling for Convolutional Neural Networks.
* Pytorch Documentation and Tutorials.
* \[사용하신 공개 데이터셋의 출처 및 논문/링크]

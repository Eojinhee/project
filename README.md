# ♻️ AI 기반 생활 폐기물 분류 시스템 (Waste Classification AI System)

## 🌟 1. 프로젝트 개요

| 항목 | 내용 |
| :--- | :--- |
| **프로젝트명** | AI 기반 생활 폐기물 분류 시스템 (Waste Classification AI System) |
| **프로젝트 목표** | 5가지 폐기물 카테고리(캔, 유리, 종이, 플라스틱, 일반쓰레기)를 정확하게 자동 분류하는 AI 모델을 구축하고 웹 서비스에 배포 |
| **개발 동기** | 육안으로 구분하기 어려운 일반쓰레기와 재활용품의 경계를 명확히 구분하여 재활용 효율 증대 |

## 🛠️ 2. 개발 환경 및 이론적 배경

### 2.1 개발 환경 및 도구

| 항목 | 내용 |
| :--- | :--- |
| **언어** | Python 3.x |
| **AI 프레임워크** | PyTorch (TorchVision) |
| **AI 모델** | EfficientNet-B0 (전이 학습) |
| **백엔드 서버** | FastAPI, Uvicorn |
| **데이터셋** | 5-Class Custom Dataset (`can`, `general`, `glass`, `paper`, `plastic`) |
| **GPU 가속** | CUDA |

### 2.2 전이 학습 및 모델 아키텍처 (EfficientNet-B0)

* **전이 학습 (Transfer Learning):** ImageNet 등 대규모 데이터셋으로 사전 학습된 모델의 가중치를 활용하여, 적은 양의 커스텀 데이터셋으로도 빠르게 높은 성능을 달성하는 학습 기법을 적용했습니다.
* **EfficientNet-B0 선택 이유:** 모델의 깊이(Depth), 너비(Width), 해상도(Resolution)를 최적으로 결합하는 **Compound Scaling** 원리가 적용되어, 경량화와 고성능을 동시에 만족시키는 모델입니다. 

## ⚙️ 3. 시스템 구조

| 구성 요소 | 역할 |
| :--- | :--- |
| **사용자 이미지 입력** | 웹 인터페이스를 통해 폐기물 이미지 파일을 서버로 업로드 |
| **이미지 전처리** | 입력 이미지를 224x224로 리사이즈 및 정규화 |
| **CNN 분류 모델** | EfficientNet-B0 모델이 **2D Convolutional Layers**를 통해 이미지 특징을 추출하고 5가지 클래스로 분류 |
| **FastAPI 서버** | 클라이언트 요청 수신, AI 모델 로드 및 추론 실행, JSON 형태로 결과 반환 |
| **웹 UI 출력** | 예측된 클래스 및 신뢰도를 사용자에게 표시 |

## 📈 4. 모델 학습 및 성능

| 항목 | 내용 |
| :--- | :--- |
| **모델 구조** | EfficientNet-B0 (Fully Connected Layer를 5개 클래스로 변경) |
| **입력** | RGB 이미지 (224x224 픽셀) |
| **출력 클래스** | Can, General, Glass, Paper, Plastic (5가지) |
| **손실 함수 / 옵티마이저** | CrossEntropyLoss / Adam (ReduceLROnPlateau 스케줄러 적용) |
| **최고 검증 정확도** | **[trainer.py 로그에 기록된 최종 최고 정확도]%** |
| **평균 추론 시간** | **CUDA 환경:** 약 0.2초 ~ 0.5초 (실시간 처리 가능)<br>**CPU 환경:** 약 1.5초 ~ 2.5초 (GPU 대비 효율성 강조) |

## 🎯 5. 문제점 및 해결 과정

본 프로젝트는 특히 **일반쓰레기(General)와 플라스틱(Plastic)의 오분류** 문제 해결에 집중했습니다.

### 5.1 일반쓰레기 오분류 문제 (데이터 보강)

* **문제:** 초기 모델은 복합 재질이나 오염된 일반쓰레기를 깨끗한 플라스틱으로 오분류하는 경향이 강했습니다.
* **해결:** 오염되거나 재활용이 불가능한 실제 일반쓰레기 사진 101장을 **Kaggle, Google 검색 등을 통해** 확보하여 `dataset/general` 폴더를 보강했습니다.
* **추가 데이터 구성 (캔/금속):** **'Can' 클래스**에는 음료 캔 외에도 알루미늄 포일 트레이, 구겨진 금속 호일 등 **재활용 가능한 기타 금속류(Metal)** 이미지를 포함하여 모델이 다양한 형태의 금속 폐기물을 포괄적으로 인식하도록 데이터 범위를 확장했습니다.
* **결과:** 재학습을 통해 `general` 클래스의 인식률이 대폭 향상되었으며, `can` 클래스의 금속류 일반화 성능도 개선되었습니다.

### 5.2 🔴 개발 중 느낀 가장 어려운 부분: 배경색 의존성 (과적합 해결)

* **문제:** 일반쓰레기 사진을 **흰색 배경**에서 촬영할 경우, 모델이 물체의 특징이 아닌 **'흰색 배경'**이라는 **편향된 정보**를 학습하여 `plastic`으로 잘못 판단하는 심각한 **배경색 과적합(Overfitting)** 문제가 발생했습니다.
* **해결:**
    * **데이터 증강 강화 (핵심 전략):** `trainer.py`의 이미지 전처리 로직 중 `ColorJitter` 파라미터를 강화했습니다. 밝기(brightness), 대비(contrast), 채도(saturation) 값을 **0.3**으로 높여 학습 데이터의 조명 및 색상 환경을 무작위로 강하게 변조했습니다. 
    * **목적:** 모델이 배경색에 덜 민감하고 **물체 자체의 시각적 특징**에 집중하도록 강제하여 일반화 성능을 높였습니다.
    * **적용 코드:** `transforms.ColorJitter(brightness=0.3, contrast=0.3, saturation=0.3, hue=0.1)`

### 5.3 서버 실행 환경 오류

* **문제:** `app.py` 실행 시 포트 8000 충돌(`Errno 10048`) 오류가 반복적으로 발생했습니다.
* **해결:** `netstat -ano | findstr :8000` 명령어로 사용 중인 프로세스 ID(PID)를 찾아 `taskkill /pid [PID] /f` 명령어로 강제 종료하여 포트를 확보하고 서버를 안정화했습니다.

### 5.4 💻 실시간 카메라 장치 충돌 해결 (Frontend/JS 수정)

* **문제:** 사용자의 노트북 환경에 **IR 카메라, 가상 카메라 등 여러 장치가 충돌**하여 `getUserMedia()` 호출이 실제 비디오 스트림을 가져오는 데 실패하는 문제가 발생했습니다. 이로 인해 실시간 카메라 기능이 작동하지 않았습니다.
* **해결:**
    * **로직 변경:** JavaScript에서 `navigator.mediaDevices.enumerateDevices()`를 통해 모든 장치 목록을 가져왔습니다.
    * **명시적 필터링:** 장치 이름(label)에 **'IR camera'** 또는 **'virtual'**이 포함된 장치를 **제외**하고, **'webcam'**이나 **'internal'** 장치를 우선순위로 명시적으로 선택하도록 로직을 수정했습니다.
* **결과:** 부적절한 장치 선택 시도를 막아 정상적인 웹캠 스트림을 성공적으로 연결했습니다.

### 5.5 개발 중 느낀 점
AI 시스템은 단순히 모델만이 아니라 **학습 데이터의 질적 관리**와 **프론트엔드/하드웨어 인터페이스**의 복잡성까지 모두 고려해야 완성도 높은 서비스가 됨을 깨달았습니다.

## 7. 제출 형식 및 부록

### 7.1 결과 분석 및 향후 개선 방향

* **결과 분석:** 최종 모델은 데이터 보강과 증강 강화를 통해 **[최고 정확도]%**의 검증 정확도를 달성했으며, **흰색 배경에서의 오분류 문제**를 성공적으로 해결하였습니다.
* **향후 개선 방향:** 실시간 카메라 모듈 통합, 추가 클래스 확장(의류, 음식물 폐기물 등).

### 7.2 제출 형식

| 항목 | 내용 |
| :--- | :--- |
| **시연 영상** | 웹 서버 접속, 흰색 배경 일반쓰레기 이미지 업로드, 분류 결과(General) 시각화 확인 |
| **부록 캡처** | 서버 실행 성공 화면, 웹 UI 메인 화면, 최종 분류 결과 화면 |

---

## 📎 8. 부록 (최종 동작 화면 캡처)

### 8.1 서버 실행 성공 화면 캡처

FastAPI 서버가 포트 8000번에서 정상적으로 실행된 화면입니다.
*첨부할 이미지: Uvicorn running on http://127.0.0.1:8000 로그가 보이는 터미널 캡처*
\[여기에 서버 실행 성공 캡처 이미지를 삽입하세요]

### 8.2 AI 분류 시스템 웹 UI (메인 화면)

AI 분류 도우미의 메인 화면입니다.
*첨부할 이미지: 프로젝트의 메인 웹 UI 캡처*
\[여기에 메인 UI 캡처 이미지를 삽입하세요]

### 8.3 최종 분류 결과 화면 캡처 (문제 해결 증명)

데이터 보강 및 모델 재학습 후, 가장 문제가 되었던 일반쓰레기(흰색 배경)를 정확하게 분류한 최종 결과입니다.

| 항목 | 내용 |
| :--- | :--- |
| **업로드된 이미지** | 흰색 배경에 놓인 일반쓰레기 (칫솔, 오염된 비닐 등) 사진 |
| **AI 분석 결과** | **일반쓰레기 (General)** |
| **신뢰도** | **[분류 시 나온 실제 신뢰도]%** |
*첨부할 이미지: 일반쓰레기(General)가 높은 신뢰도로 정확하게 분류된 웹 UI 캡처*
\[여기에 최종 분류 결과 캡처 이미지를 삽입하세요]

---
## 9. 참고 문헌
* Tan, M., & Le, Q. V. (2019). EfficientNet: Rethinking Model Scaling for Convolutional Neural Networks.
* Pytorch Documentation and Tutorials.
* **[주요 데이터셋 출처]** [(Waste Classification Dataset, Kaggle Repository)](https://www.kaggle.com/datasets/asdasdasasdas/garbage-classification)
* **[일반쓰레기 보강 데이터]** (예시: Google Image Search and Manual Collection for specific General Waste types)
* \[추가적으로 사용하신 공개 데이터셋의 출처 및 논문/링크]








# 2번시안 



# 🏆 [2025학년도 캡스톤디자인 최종보고서]

# ♻️ EfficientNet 기반 실시간 생활 폐기물 분류 시스템
**(Real-time Waste Classification System based on EfficientNet)**

## 🌟 1. 프로젝트 개요 및 목표

### 1.1 개발 배경 및 필요성
현대 사회에서 생활 폐기물의 복합 재질화 및 오염된 폐기물의 모호한 분류 기준으로 인해 재활용 효율이 저하되고 있습니다. 특히 **'오염된 일반쓰레기'**와 **'재활용 가능한 플라스틱'** 간의 오분류는 자원 순환의 가장 큰 걸림돌입니다. 이에 본 프로젝트는 딥러닝 기술을 활용하여 폐기물을 명확히 구분하고, 사용자에게 올바른 분리배출 가이드를 제공하여 재활용 효율을 증대시키는 것을 목표로 합니다.

### 1.2 프로젝트 목표

1.  **정밀 자동 분류:** 5가지 핵심 카테고리(캔, 유리, 종이, 플라스틱, 일반쓰레기)를 정확하게 식별하는 AI 모델 구축.
2.  **웹 서비스 배포:** 사용자가 웹캠이나 이미지 업로드를 통해 손쉽게 접근 가능한 **반응형 웹 인터페이스** 구현.
3.  **오분류 개선:** 기존 모델들이 취약했던 **'흰색 배경 편향'** 및 **'일반쓰레기 혼동'** 문제를 데이터 및 전처리 기술로 해결.

---

## 🛠️ 2. 개발 환경 및 이론적 배경

### 2.1 개발 환경 (Environment)

| 항목 | 요소 | 내용 |
| :--- | :--- | :--- |
| **AI 모델 프레임워크** | PyTorch (TorchVision) | 모델 개발 및 학습 |
| **모델 아키텍처** | **EfficientNet-B0** | 경량화와 고성능을 동시에 달성 |
| **백엔드 서버** | **FastAPI** (Uvicorn) | 비동기 추론 서버 구축 |
| **프론트엔드** | HTML5, JavaScript (WebRTC), Tailwind CSS | 반응형 웹 UI 및 카메라 제어 |
| **GPU 가속** | CUDA | 고속 모델 학습 및 추론 |

### 2.2 모델 아키텍처 및 학습 전략

* **EfficientNet-B0 선정:** 모델의 **깊이(Depth), 너비(Width), 해상도(Resolution)**를 최적으로 결합하는 **Compound Scaling** 원리가 적용된 모델입니다.  웹 서비스 환경에 적합하도록 경량화와 고성능을 동시에 달성할 수 있습니다.
* **전이 학습 (Transfer Learning):** ImageNet으로 사전 학습된 가중치(Pre-trained Weights)를 활용하여, 제한된 커스텀 데이터셋으로도 빠른 수렴 속도와 높은 정확도를 확보하였습니다.

---

## ⚙️ 3. 시스템 설계 및 처리 프로세스

### 3.1 시스템 구성 요소 및 역할

| 구성 요소 | 역할 |
| :--- | :--- |
| **클라이언트 (웹 UI)** | 사용자 이미지 입력 (웹캠/업로드) 및 결과 시각화 |
| **이미지 전처리** | 입력 이미지를 224x224로 리사이즈 및 정규화 |
| **CNN 분류 모델** | EfficientNet-B0이 이미지 특징을 추출하고 5가지 클래스로 분류 |
| **FastAPI 서버** | 클라이언트 요청 수신, AI 추론 실행, JSON 형태로 예측 결과 반환 |

### 3.2 데이터셋 구성

* **기본 5개 클래스:** Can, General, Glass, Paper, Plastic
* **Can 클래스 확장:** 단순 음료 캔뿐만 아니라 알루미늄 트레이, 구겨진 포일 등 **재활용 가능한 금속류(Metal)** 전반을 인식하도록 데이터 범위를 확장하였습니다.

---

## 🎯 4. 핵심 문제 해결 (Problem Solving) ⭐

본 프로젝트의 가장 중요한 성과는 실제 서비스 환경에서 발생하는 **치명적인 오분류 및 하드웨어 충돌 문제**를 공학적으로 해결한 과정에 있습니다.

### 4.1 일반쓰레기 오분류 및 데이터 불균형 해결

* **문제:** 초기 모델이 오염된 일반쓰레기를 깨끗한 플라스틱으로 오인하는 경향 발생 (General 클래스 인식률 저하).
* **해결 (Hard Negative Mining):** 오염되거나 복합 재질인 실제 일반쓰레기 이미지 101장을 직접 수집하여(Hard Negative Mining) `dataset/general` 폴더를 보강했습니다.
* **결과:** 재학습 후 General 클래스 인식률이 대폭 향상되어 플라스틱과의 혼동이 최소화되었습니다.

### 4.2 [Critical] 흰색 배경 과적합(Background Bias Overfitting) 해결

* **문제:** 일반쓰레기를 **흰색 배경(책상, 벽)**에서 촬영 시, 모델이 객체의 특징이 아닌 **'흰색 배경'이라는 편향된 정보**를 학습하여 '플라스틱'으로 오분류하는 심각한 배경색 과적합 문제가 발생했습니다.
* **해결 (데이터 증강 강화 - 핵심 전략):** `trainer.py`의 전처리 로직 중 **`ColorJitter` 파라미터를 강화 적용**했습니다.
    * **적용 코드:** `transforms.ColorJitter(brightness=0.3, contrast=0.3, saturation=0.3, hue=0.1)`
    * **목적:** 조명 및 색상 환경을 강하게 변조하여 모델이 배경색에 덜 민감하고 **물체 고유의 형상 및 질감**에 집중하도록 강제하여 일반화 성능을 높였습니다.

### 4.3 실시간 카메라 장치 충돌 해결 (Frontend)

* **문제:** 사용자 노트북에 **IR 카메라**나 **가상 카메라** 등 여러 장치가 충돌하여 `getUserMedia()`가 적절한 장치 스트림을 가져오는 데 실패하는 문제 발생.
* **해결:** JavaScript `navigator.mediaDevices.enumerateDevices()` API를 사용해 장치 목록을 스캔한 뒤, 장치 이름(label)에 **'IR'** 또는 **'Virtual'**이 포함된 장치를 **명시적으로 필터링 및 제외**하고 'Webcam' 또는 'Internal' 장치를 우선 연결하는 로직을 구현하여 호환성을 확보했습니다.

---

## 5. 성능 평가 및 결과 분석

### 5.1 모델 최종 성능

| 항목 | 성능 지표 | 값 |
| :--- | :--- | :--- |
| **최고 검증 정확도 (Best Validation Acc)** | Accuracy | **[최종 정확도 입력]%** |
| **GPU (CUDA) 추론 시간** | 평균 | 약 0.2초 ~ 0.5초 (실시간 처리 가능) |
| **CPU 추론 시간** | 평균 | 약 1.5초 ~ 2.5초 |

### 5.2 결과 분석 및 결론

최종 모델은 데이터 보강과 증강(Augmentation) 강화를 통해, 프로젝트의 가장 큰 난제였던 **'흰색 배경에서의 일반쓰레기 오분류' 문제**를 성공적으로 해결하며 **[최고 정확도]%**의 검증 정확도를 달성했습니다. 또한, 프론트엔드 장치 제어 로직 개선을 통해 다양한 사용자 환경에서의 호환성을 확보하였습니다.

---

## 6. 향후 개선 방향

1.  **실시간 객체 탐지 (Object Detection) 도입:** 이미지 분류를 넘어 여러 쓰레기를 동시에 탐지하고 위치를 파악하는 시스템으로 확장.
2.  **클래스 확장:** 의류, 음식물 폐기물 등 분류 카테고리 다변화.
3.  **모바일 앱 개발:** 웹이 아닌 네이티브 앱 환경으로 서비스 확장.

---

## 7. 부록 (최종 동작 화면)

### 7.1 서버 실행 성공 화면

<img width="1203" height="1021" alt="8000" src="https://github.com/user-attachments/assets/b4c9892e-562b-4e8a-b0e6-c0adc8ed5a03" />



### 7.2 AI 분류 시스템 웹 UI (메인 화면)
<img width="979" height="1121" alt="1" src="https://github.com/user-attachments/assets/9474f575-482d-4937-9d66-849c089a1838" />
<img width="859" height="923" alt="image" src="https://github.com/user-attachments/assets/9a6a3390-0057-4898-948b-043d445e10fe" />



### 7.3 최종 분류 결과 화면 (문제 해결 증명) ⭐

| 항목 | 내용 |
| :--- | :--- |
| **업로드된 이미지** | 일반쓰레기 봉투 사진 |
| **AI 분석 결과** | **일반쓰레기 (General)** |
| **신뢰도** | **[100]%** |
<img width="868" height="1002" alt="3" src="https://github.com/user-attachments/assets/966eeb20-3549-442a-9b38-19e6be0312b1" />

| 항목 | 내용 |
| :--- | :--- |
| **업로드된 이미지** | 흰색 배경에 놓인 패트병 사진 |
| **AI 분석 결과** | **플라스틱 (Plastic)** |
| **신뢰도** | **[99.8]%** |
<img width="815" height="1016" alt="4" src="https://github.com/user-attachments/assets/eab8d7dd-b77d-409c-b789-c3e3298615e1" />



---

## 8. 참고 문헌

* Tan, M., & Le, Q. V. (2019). EfficientNet: Rethinking Model Scaling for Convolutional Neural Networks.
* PyTorch Documentation and Tutorials.
* **[주요 데이터셋 출처]** [(Waste Classification Dataset, Kaggle Repository)](https://www.kaggle.com/datasets/asdasdasasdas/garbage-classification)
* **[ 보강 데이터]** (Google Image Search and Manual Collection for specific General Waste types)
